<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pet'emote | Understand Your Pet Better</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* CSS Variables for Design System */
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --primary: 262 52% 47%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96.1%;
            --secondary-foreground: 222.2 47.4% 11.2%;
            --muted: 210 40% 96.1%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 262 80% 95%;
            --accent-foreground: 262 52% 47%;
            --border: 214.3 31.8% 91.4%;
            --radius: 0.5rem;
        }

        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --primary: 262 80% 65%;
            --primary-foreground: 222.2 47.4% 11.2%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 262 40% 25%;
            --accent-foreground: 262 80% 80%;
            --border: 217.2 32.6% 17.5%;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, hsl(262 100% 98%) 0%, hsl(262 80% 95%) 50%, hsl(262 60% 92%) 100%);
            color: hsl(var(--foreground));
            min-height: 100vh;
            transition: all 0.5s ease;
        }

        .dark body {
            background: linear-gradient(135deg, hsl(222.2 84% 4.9%) 0%, hsl(262 40% 15%) 50%, hsl(262 60% 8%) 100%);
        }

        /* Header Styles */
        header {
            background: hsla(var(--card) / 0.95);
            backdrop-filter: blur(12px);
            position: sticky;
            top: 0;
            z-index: 40;
            box-shadow: 0 4px 6px -1px hsla(0 0% 0% / 0.1);
            border-bottom: 1px solid hsl(var(--border));
        }

        .header-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            height: 5rem;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .logo {
            width: 3rem;
            height: 3rem;
            background: linear-gradient(135deg, hsl(262 80% 60%) 0%, hsl(320 70% 60%) 100%);
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 6px -1px hsla(0 0% 0% / 0.1);
        }

        .logo svg {
            width: 1.75rem;
            height: 1.75rem;
            color: white;
        }

        .site-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: hsl(var(--foreground));
            margin: 0;
        }

        .nav {
            display: flex;
            align-items: center;
            gap: 2rem;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-link {
            font-weight: 600;
            color: hsl(var(--foreground) / 0.7);
            text-decoration: none;
            position: relative;
            transition: all 0.3s ease;
        }

        .nav-link:hover,
        .nav-link.active {
            color: hsl(var(--primary));
        }

        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -0.25rem;
            left: 0;
            right: 0;
            height: 0.125rem;
            background: hsl(var(--primary));
            border-radius: 9999px;
        }

        .dark-toggle {
            padding: 0.5rem;
            border-radius: 0.5rem;
            background: hsl(var(--accent));
            color: hsl(var(--accent-foreground));
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dark-toggle:hover {
            background: hsl(var(--accent) / 0.8);
        }

        .dark-toggle svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Main Content */
        .main-container {
            max-width: 64rem;
            margin: 0 auto;
            padding: 3rem 1rem;
        }

        .content-card {
            background: hsla(var(--card) / 0.8);
            backdrop-filter: blur(12px);
            border-radius: 1rem;
            box-shadow: 0 25px 50px -12px hsla(0 0% 0% / 0.25);
            border: 1px solid hsl(var(--border));
            overflow: hidden;
        }

        /* Sections */
        .section {
            padding: 2rem;
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.6s ease, transform 0.6s ease;
        }

        .section.active {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .section-title {
            font-size: 2.25rem;
            font-weight: 700;
            text-align: center;
            margin-bottom: 2rem;
            color: hsl(var(--primary));
        }

        .section-subtitle {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: hsl(var(--foreground));
        }

        .section-text {
            font-size: 1.125rem;
            line-height: 1.7;
            margin-bottom: 1.5rem;
            color: hsl(var(--muted-foreground));
        }

        /* Feature Cards */
        .features-grid {
            display: grid;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .feature-card {
            background: hsl(var(--accent));
            padding: 1.5rem;
            border-radius: 0.5rem;
            border-left: 4px solid hsl(var(--primary));
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            box-shadow: 0 10px 15px -3px hsla(0 0% 0% / 0.1);
            transform: translateY(-2px);
        }

        .feature-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .feature-icon {
            color: hsl(var(--primary));
            margin-top: 0.25rem;
        }

        .feature-icon svg {
            width: 1.5rem;
            height: 1.5rem;
        }

        .feature-title {
            font-weight: 600;
            color: hsl(var(--foreground));
            margin-bottom: 0.5rem;
        }

        .feature-description {
            color: hsl(var(--muted-foreground));
        }

        /* Steps */
        .steps-list {
            margin-bottom: 2rem;
        }

        .step-card {
            background: linear-gradient(135deg, hsl(var(--accent)) 0%, hsl(320 80% 95%) 100%);
            padding: 1.5rem;
            border-radius: 0.5rem;
            border-left: 4px solid hsl(var(--primary));
            margin-bottom: 1rem;
            transition: all 0.3s ease;
        }

        .step-card:hover {
            box-shadow: 0 10px 15px -3px hsla(0 0% 0% / 0.1);
        }

        .step-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }

        .step-number {
            background: hsl(var(--primary));
            color: white;
            width: 2rem;
            height: 2rem;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
            flex-shrink: 0;
        }

        .step-title {
            font-weight: 600;
            color: hsl(var(--foreground));
            margin-bottom: 0.5rem;
        }

        .step-description {
            color: hsl(var(--muted-foreground));
        }

        /* Content List */
        .content-list {
            margin-bottom: 2rem;
        }

        .content-list ul {
            list-style: none;
            padding: 0;
        }

        .content-list li {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 0.75rem;
            color: hsl(var(--muted-foreground));
        }

        .content-list li svg {
            width: 1.25rem;
            height: 1.25rem;
            color: hsl(var(--primary));
        }

        /* Forms */
        .form {
            max-width: 28rem;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: hsl(var(--foreground));
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid hsl(var(--border));
            border-radius: calc(var(--radius));
            background: hsl(var(--card));
            color: hsl(var(--foreground));
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border-color: hsl(var(--primary));
            box-shadow: 0 0 0 2px hsl(var(--primary) / 0.2);
        }

        .form-button {
            width: 100%;
            background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(320 70% 50%) 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: calc(var(--radius));
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .form-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px hsla(0 0% 0% / 0.1);
        }

        .divider {
            position: relative;
            text-align: center;
            margin: 1.5rem 0;
        }

        .divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: hsl(var(--border));
        }

        .divider span {
            background: hsl(var(--card));
            padding: 0 0.5rem;
            color: hsl(var(--muted-foreground));
            font-size: 0.875rem;
        }

        .google-button {
            width: 100%;
            background: #4285F4;
            color: white;
            padding: 0.75rem 1rem;
            border-radius: calc(var(--radius));
            font-weight: 600;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            margin-top: 1rem;
        }

        .google-button:hover {
            background: #357ae8;
            transform: translateY(-2px);
        }

        .form-link {
            text-align: center;
            margin-top: 1.5rem;
            color: hsl(var(--muted-foreground));
        }

        .form-link a {
            color: hsl(var(--primary));
            text-decoration: none;
            font-weight: 600;
            transition: color 0.3s ease;
        }

        .form-link a:hover {
            color: hsl(var(--primary) / 0.8);
        }

        /* CTA Button */
        .cta-section {
            text-align: center;
            margin-top: 2rem;
        }

        .cta-button {
            background: linear-gradient(135deg, hsl(var(--primary)) 0%, hsl(320 70% 50%) 100%);
            color: white;
            padding: 0.75rem 2rem;
            border-radius: calc(var(--radius));
            font-weight: 600;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.3s ease;
            border: none;
            cursor: pointer;
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 15px -3px hsla(0 0% 0% / 0.1);
        }

        .cta-button svg {
            width: 1.25rem;
            height: 1.25rem;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: hsla(0 0% 0% / 0.4);
            z-index: 50;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: hsl(var(--card));
            padding: 1.5rem;
            border-radius: 0.5rem;
            box-shadow: 0 25px 50px -12px hsla(0 0% 0% / 0.25);
            max-width: 28rem;
            width: 90%;
            margin: 1rem;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.5rem;
            font-weight: 700;
            color: hsl(var(--muted-foreground));
            cursor: pointer;
            transition: color 0.3s ease;
        }

        .modal-close:hover {
            color: hsl(var(--primary));
        }

        .modal-message {
            color: hsl(var(--foreground));
            margin-bottom: 1rem;
        }

        .modal-button {
            background: hsl(var(--primary));
            color: white;
            padding: 0.5rem 1.5rem;
            border-radius: calc(var(--radius));
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .modal-button:hover {
            background: hsl(var(--primary) / 0.9);
            transform: translateY(-1px);
        }

        /* Footer */
        footer {
            background: hsla(var(--card) / 0.8);
            backdrop-filter: blur(12px);
            border-top: 1px solid hsl(var(--border));
            padding: 2rem;
            text-align: center;
            box-shadow: 0 -4px 6px -1px hsla(0 0% 0% / 0.1);
        }

        .footer-text {
            color: hsl(var(--muted-foreground));
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                height: auto;
                padding: 1rem;
                gap: 1rem;
            }

            .nav-links {
                flex-wrap: wrap;
                gap: 1rem;
                justify-content: center;
            }

            .main-container {
                padding: 1.5rem 1rem;
            }

            .section {
                padding: 1.5rem;
            }

            .section-title {
                font-size: 2rem;
                margin-bottom: 1.5rem;
            }

            .nav {
                flex-direction: column;
                gap: 1rem;
            }
        }

        /* Animation keyframes */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .section.active {
            animation: fadeIn 0.6s ease-out;
        }
    </style>
</head>
<body>
    <header>
        <div class="header-container">
            <div class="logo-section">
                <div class="logo">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5l7 7Z"/>
                    </svg>
                </div>
                <h1 class="site-title">Pet'emote</h1>
            </div>
            <nav class="nav">
                <div class="nav-links">
                    <a href="#" class="nav-link active" data-section="about">About</a>
                    <a href="#" class="nav-link" data-section="how-it-works">How It Works</a>
                    <a href="#" class="nav-link" data-section="login">Login</a>
                    <a href="#" class="nav-link" data-section="signup">Sign Up</a>
                    <a href="#" class="nav-link" data-section="profile">Profile</a>
                    <a href="#" class="nav-link" data-section="pets">Pets</a>
                    <a href="#" class="nav-link" data-section="activity">Activity Log</a>
                    <a href="#" class="nav-link" data-section="settings">Settings</a>
                    <a href="#" class="nav-link" id="signOutButton">Sign Out</a>
                </div>
                <button id="darkToggle" class="dark-toggle">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"/>
                    </svg>
                </button>
            </nav>
        </div>
    </header>

    <main class="main-container">
        <div class="content-card">
            <section id="about" class="section active">
                <h2 class="section-title">Welcome to Pet'emote</h2>
                <p class="section-text">
                    Pet'emote is designed to help you understand your pet's emotions and needs better.
                    By tracking their activities and behaviors, you can gain insights into their well-being,
                    strengthen your bond, and provide them with the best possible care.
                </p>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-header">
                            <span class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7.9 20A9 9 0 1 0 4 16.1L2 22Z"/></svg></span>
                            <h3 class="feature-title">Emotion Tracking</h3>
                        </div>
                        <p class="feature-description">Log your pet's emotional states throughout the day.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-header">
                            <span class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 12H4M2 9l20 3-20 3m18-3L4 9l18 3L4 15"/></svg></span>
                            <h3 class="feature-title">Activity Logging</h3>
                        </div>
                        <p class="feature-description">Keep a detailed record of feeding, walks, playtime, and more.</p>
                    </div>
                    <div class="feature-card">
                        <div class="feature-header">
                            <span class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v6"/><path d="M11 10 5 6 2 7l3 6z"/><path d="M12 15v5h7l-7-7Z"/><path d="M19 19V7l3 2-3 3Z"/></svg></span>
                            <h3 class="feature-title">Insightful Analytics</h3>
                        </div>
                        <p class="feature-description">Visualize patterns and trends in your pet's behavior over time.</p>
                    </div>
                </div>
                <div class="cta-section">
                    <a href="#" class="cta-button" data-section="signup">
                        Get Started <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m5 12 7-7 7 7"/><path d="M12 19V5"/></svg>
                    </a>
                </div>
            </section>

            <section id="how-it-works" class="section">
                <h2 class="section-title">How Pet'emote Works</h2>
                <div class="steps-list">
                    <div class="step-card">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <div>
                                <h3 class="step-title">Create Your Profile</h3>
                                <p class="step-description">Sign up and tell us a bit about yourself.</p>
                            </div>
                        </div>
                    </div>
                    <div class="step-card">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <div>
                                <h3 class="step-title">Add Your Pets</h3>
                                <p class="step-description">Register each of your beloved pets with their unique details.</p>
                            </div>
                        </div>
                    </div>
                    <div class="step-card">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <div>
                                <h3 class="step-title">Log Activities & Emotions</h3>
                                <p class="step-description">Easily record daily activities, moods, and significant events.</p>
                            </div>
                        </div>
                    </div>
                    <div class="step-card">
                        <div class="step-header">
                            <span class="step-number">4</span>
                            <div>
                                <h3 class="step-title">Gain Insights</h3>
                                <p class="step-description">View trends, identify patterns, and understand your pet's well-being.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <h3 class="section-subtitle">What You Can Track:</h3>
                <div class="content-list">
                    <ul>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Emotional States (Happy, Anxious, Playful, etc.)</li>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Feeding Times & Amounts</li>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Walk Durations & Routes</li>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Playtime & Training Sessions</li>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Vet Visits & Medications</li>
                        <li><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/></svg> Potty Breaks</li>
                    </ul>
                </div>
            </section>

            <section id="login" class="section">
                <h2 class="section-title">Login</h2>
                <form id="loginForm" class="form">
                    <div class="form-group">
                        <label for="loginEmail">Email:</label>
                        <input type="email" id="loginEmail" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">Password:</label>
                        <input type="password" id="loginPassword" class="form-input" required>
                    </div>
                    <button type="submit" class="form-button">Login</button>
                    <div class="divider"><span>OR</span></div>
                    <button type="button" id="googleLoginButton" class="google-button">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                            <path d="M12.24 10.232v2.448h6.216c-.256 1.76-1.54 2.87-3.528 2.87-2.188 0-3.96-1.92-3.96-4.32s1.772-4.32 3.96-4.32c1.176 0 2.032.48 2.58 1.016l1.92-1.896c-1.124-1.028-2.6-1.584-4.5-1.584-3.724 0-6.764 3.06-6.764 6.84s3.04 6.84 6.764 6.84c3.96 0 6.64-2.82 6.64-6.68 0-.48-.052-.892-.124-1.304H12.24z"/>
                        </svg>
                        Sign in with Google
                    </button>
                    <p class="form-link">Don't have an account? <a href="#" data-section="signup">Sign Up</a></p>
                    <p class="form-link"><a href="#" id="forgotPasswordLink">Forgot Password?</a></p>
                </form>
            </section>

            <section id="signup" class="section">
                <h2 class="section-title">Sign Up</h2>
                <form id="signupForm" class="form">
                    <div class="form-group">
                        <label for="signupName">Name:</label>
                        <input type="text" id="signupName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="signupEmail">Email:</label>
                        <input type="email" id="signupEmail" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="signupPassword">Password:</label>
                        <input type="password" id="signupPassword" class="form-input" required>
                    </div>
                    <button type="submit" class="form-button">Sign Up</button>
                    <div class="divider"><span>OR</span></div>
                    <button type="button" id="googleSignupButton" class="google-button">
                        <svg viewBox="0 0 24 24" fill="currentColor" width="20" height="20">
                            <path d="M12.24 10.232v2.448h6.216c-.256 1.76-1.54 2.87-3.528 2.87-2.188 0-3.96-1.92-3.96-4.32s1.772-4.32 3.96-4.32c1.176 0 2.032.48 2.58 1.016l1.92-1.896c-1.124-1.028-2.6-1.584-4.5-1.584-3.724 0-6.764 3.06-6.764 6.84s3.04 6.84 6.764 6.84c3.96 0 6.64-2.82 6.64-6.68 0-.48-.052-.892-.124-1.304H12.24z"/>
                        </svg>
                        Sign up with Google
                    </button>
                    <p class="form-link">Already have an account? <a href="#" data-section="login">Login</a></p>
                </form>
            </section>

            <section id="profile" class="section">
                <h2 class="section-title">User Profile</h2>
                <form id="profileForm" class="form">
                    <div class="form-group">
                        <label for="profileName">Name:</label>
                        <input type="text" id="profileName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="profileEmail">Email:</label>
                        <input type="email" id="profileEmail" class="form-input" disabled>
                    </div>
                    <button type="submit" class="form-button">Update Profile</button>
                </form>
                <div class="cta-section" style="margin-top: 2rem;">
                    <button id="deleteAccountButton" class="cta-button" style="background: #ef4444;">
                        Delete Account <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/></svg>
                    </button>
                </div>
            </section>

            <section id="pets" class="section">
                <h2 class="section-title">Your Pets</h2>
                <form id="addPetForm" class="form">
                    <h3 class="section-subtitle">Add New Pet</h3>
                    <div class="form-group">
                        <label for="petName">Pet Name:</label>
                        <input type="text" id="petName" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="petSpecies">Species:</label>
                        <input type="text" id="petSpecies" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label for="petBreed">Breed (optional):</label>
                        <input type="text" id="petBreed" class="form-input">
                    </div>
                    <div class="form-group">
                        <label for="petDOB">Date of Birth (optional):</label>
                        <input type="date" id="petDOB" class="form-input">
                    </div>
                    <button type="submit" class="form-button">Add Pet</button>
                </form>
                <h3 class="section-subtitle" style="margin-top: 2rem;">Your Registered Pets</h3>
                <div id="petsList" class="content-list">
                    <p style="text-align: center; color: hsl(var(--muted-foreground));">No pets added yet.</p>
                </div>
            </section>

            <section id="activity" class="section">
                <h2 class="section-title">Activity Log</h2>
                <form id="logActivityForm" class="form">
                    <h3 class="section-subtitle">Log New Activity</h3>
                    <div class="form-group">
                        <label for="activityPetSelect">Select Pet:</label>
                        <select id="activityPetSelect" class="form-input" required>
                            <option value="">-- Select a Pet --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="activityType">Activity Type:</label>
                        <select id="activityType" class="form-input" required>
                            <option value="">-- Select Type --</option>
                            <option value="feeding">Feeding</option>
                            <option value="walk">Walk</option>
                            <option value="playtime">Playtime</option>
                            <option value="training">Training</option>
                            <option value="vet_visit">Vet Visit</option>
                            <option value="medication">Medication</option>
                            <option value="potty">Potty Break</option>
                            <option value="emotion_happy">Emotion: Happy</option>
                            <option value="emotion_anxious">Emotion: Anxious</option>
                            <option value="emotion_playful">Emotion: Playful</option>
                            <option value="emotion_calm">Emotion: Calm</option>
                            <option value="emotion_tired">Emotion: Tired</option>
                            <option value="other">Other</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="activityNotes">Notes (optional):</label>
                        <textarea id="activityNotes" class="form-input" rows="3"></textarea>
                    </div>
                    <button type="submit" class="form-button">Log Activity</button>
                </form>
                <h3 class="section-subtitle" style="margin-top: 2rem;">Recent Activities</h3>
                <div id="activityLogList" class="content-list">
                    <p style="text-align: center; color: hsl(var(--muted-foreground));">No activities logged yet.</p>
                </div>
            </section>

            <section id="settings" class="section">
                <h2 class="section-title">Settings</h2>
                <div class="form-group">
                    <label>Dark Mode:</label>
                    <button id="settingsDarkToggle" class="form-button" style="width: auto; padding: 0.5rem 1rem;">Toggle Dark Mode</button>
                </div>
                <h3 class="section-subtitle" style="margin-top: 2rem;">Firebase Configuration</h3>
                <p class="section-text">
                    Your Firebase project is initialized. Ensure your `firebaseConfig` is correct and your Realtime Database rules are set up for proper read/write access.
                </p>
                <p class="section-text">
                    For authentication issues like "account-exists-with-different-credential", ensure "Multiple accounts per email address" is enabled in your Firebase project's Authentication settings via the Firebase Console.
                </p>
            </section>
        </div>
    </main>

    <footer>
        <p class="footer-text">&copy; 2025 Pet'emote. All rights reserved.</p>
    </footer>

    <div id="modal" class="modal">
        <div class="modal-content">
            <span class="modal-close" id="modalCloseButton">&times;</span>
            <p id="modalMessage" class="modal-message"></p>
            <button id="modalOkButton" class="modal-button">OK</button>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

    <script>
        // Your Firebase project configuration
        // Replace with your actual Firebase config
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID",
            measurementId: "YOUR_MEASUREMENT_ID"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const database = firebase.database();

        let currentUser = null;

        // DOM Elements
        const navLinks = document.querySelectorAll('.nav-link');
        const sections = document.querySelectorAll('.section');
        const loginForm = document.getElementById('loginForm');
        const signupForm = document.getElementById('signupForm');
        const profileForm = document.getElementById('profileForm');
        const addPetForm = document.getElementById('addPetForm');
        const logActivityForm = document.getElementById('logActivityForm');

        const googleLoginButton = document.getElementById('googleLoginButton');
        const googleSignupButton = document.getElementById('googleSignupButton');
        const signOutButton = document.getElementById('signOutButton');
        const forgotPasswordLink = document.getElementById('forgotPasswordLink');
        const deleteAccountButton = document.getElementById('deleteAccountButton');

        const profileNameInput = document.getElementById('profileName');
        const profileEmailInput = document.getElementById('profileEmail');
        const petsList = document.getElementById('petsList');
        const activityPetSelect = document.getElementById('activityPetSelect');
        const activityLogList = document.getElementById('activityLogList');

        const modal = document.getElementById('modal');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseButton = document.getElementById('modalCloseButton');
        const modalOkButton = document.getElementById('modalOkButton');

        const darkToggle = document.getElementById('darkToggle');
        const settingsDarkToggle = document.getElementById('settingsDarkToggle');


        // --- Helper Functions ---

        function showModal(message) {
            modalMessage.textContent = message;
            modal.style.display = 'flex';
        }

        function closeModal() {
            modal.style.display = 'none';
        }

        modalCloseButton.addEventListener('click', closeModal);
        modalOkButton.addEventListener('click', closeModal);

        function showSection(sectionId) {
            sections.forEach(section => {
                section.classList.remove('active');
            });
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.classList.add('active');
            }

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.dataset.section === sectionId) {
                    link.classList.add('active');
                }
            });
            // Handle sign out button active state
            if (sectionId === 'signOut') {
                signOutButton.classList.add('active');
            } else {
                signOutButton.classList.remove('active');
            }
        }

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const sectionId = e.target.dataset.section;
                if (sectionId) {
                    showSection(sectionId);
                }
            });
        });

        // --- Firebase Authentication Functions ---

        async function signUp(email, password, name) {
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                const user = userCredential.user;
                await user.updateProfile({ displayName: name });
                await saveUserProfile(user.uid, name, email);
                showModal("Sign up successful! Welcome, " + name + ".");
                showSection('profile'); // Redirect to profile after signup
            } catch (error) {
                console.error("Sign up error:", error);
                let errorMessage = "Sign up failed: " + error.message;
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = "This email is already in use.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Please enter a valid email address.";
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = "Password is too weak. It should be at least 6 characters.";
                }
                showModal(errorMessage);
            }
        }

        async function signIn(email, password) {
            try {
                await auth.signInWithEmailAndPassword(email, password);
                showModal("Signed in successfully!");
                showSection('profile'); // Redirect to profile after login
            } catch (error) {
                console.error("Sign in error:", error);
                let errorMessage = "Sign in failed: " + error.message;
                if (error.code === 'auth/user-not-found' || error.code === 'auth/wrong-password') {
                    errorMessage = "Invalid email or password.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Please enter a valid email address.";
                }
                showModal(errorMessage);
            }
        }

        async function handleGoogleSignIn() {
            const provider = new firebase.auth.GoogleAuthProvider();
            try {
                const result = await auth.signInWithPopup(provider);
                const user = result.user;
                const isNewUser = result.additionalUserInfo.isNewUser;

                if (isNewUser) {
                    await saveUserProfile(user.uid, user.displayName || 'Google User', user.email);
                    showModal("Google Sign-in successful! Welcome, " + (user.displayName || 'Google User') + ".");
                } else {
                    showModal("Welcome back, " + (user.displayName || 'User') + "!");
                }
                showSection('profile');
            } catch (error) {
                console.error("Google Sign-in error:", error);
                let errorMessage = "Google Sign-in failed: " + error.message;

                if (error.code === 'auth/popup-closed-by-user') {
                    errorMessage = "Google Sign-In was cancelled.";
                } else if (error.code === 'auth/cancelled-popup-request') {
                    errorMessage = "Sign-in already in progress. Please wait or try again.";
                } else if (error.code === 'auth/account-exists-with-different-credential') {
                    const email = error.email;
                    const pendingCredential = error.credential;

                    // This part implements the account linking logic
                    try {
                        const methods = await auth.fetchSignInMethodsForEmail(email);
                        if (methods && methods.length > 0) {
                            let message = `An account with ${email} already exists using a different sign-in method. Please sign in using your existing method (${methods.join(', ')}) first, then link your Google account from your profile if you wish.`;

                            // Special handling if email enumeration protection is enabled (Firebase Console > Authentication > Settings)
                            // If it's enabled, fetchSignInMethodsForEmail will not return actual methods for non-existent emails,
                            // but for existing ones, it might still provide a general "password" method if that's the main conflict.
                            if (methods.includes('password')) {
                                message = `An account with ${email} already exists. Please sign in with your email and password, then you can link your Google account from your profile settings.`;
                            } else if (methods.length > 1) { // If multiple non-password methods
                                message = `An account with ${email} already exists using another social login. Please sign in with one of your existing methods (${methods.join(', ')}) first, then link your Google account.`;
                            }
                            showModal(message);
                            // Optionally, you could try to sign in with the existing method
                            // For example, if 'password' is a method, prompt for password login:
                            // if (methods.includes('password')) {
                            //     // Prompt user for password for 'email'
                            //     const passwordPrompt = prompt("Please enter your password to link your accounts:");
                            //     if (passwordPrompt) {
                            //         const credential = firebase.auth.EmailAuthProvider.credential(email, passwordPrompt);
                            //         auth.signInWithCredential(credential)
                            //             .then((userCredential) => {
                            //                 // User signed in with existing credential, now link the new one
                            //                 return userCredential.user.linkWithCredential(pendingCredential);
                            //             })
                            //             .then(() => {
                            //                 showModal("Accounts successfully linked!");
                            //                 showSection('profile');
                            //             })
                            //             .catch((linkError) => {
            //                                     console.error("Error during linking after sign-in:", linkError);
            //                                     showModal("Error linking accounts: " + linkError.message);
            //                                 });
                            //     }
                            // }
                        } else {
                            // This case might happen if email enumeration protection is strongly enforced
                            // and fetchSignInMethodsForEmail returns empty for security.
                            // In this scenario, Firebase *knows* the email exists, but won't tell *how*.
                            errorMessage = "An account with this email already exists. Please sign in with your existing method.";
                            showModal(errorMessage);
                        }
                    } catch (fetchError) {
                        console.error("Error fetching sign-in methods:", fetchError);
                        errorMessage = "An account with this email already exists with a different sign-in method. Please try logging in with your original method.";
                        showModal(errorMessage);
                    }
                }
                showModal(errorMessage);
            }
        }

        async function signOutUser() {
            try {
                await auth.signOut();
                showModal("You have been signed out.");
                showSection('about'); // Redirect to about page after sign out
            } catch (error) {
                console.error("Sign out error:", error);
                showModal("Sign out failed: " + error.message);
            }
        }

        async function resetPassword(email) {
            try {
                await auth.sendPasswordResetEmail(email);
                showModal("Password reset email sent to " + email + ". Please check your inbox.");
            } catch (error) {
                console.error("Password reset error:", error);
                let errorMessage = "Password reset failed: " + error.message;
                if (error.code === 'auth/user-not-found') {
                    errorMessage = "No account found with this email.";
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = "Please enter a valid email address.";
                }
                showModal(errorMessage);
            }
        }

        async function deleteAccount() {
            const user = auth.currentUser;
            if (user) {
                const confirmDelete = confirm("Are you sure you want to delete your account? This action cannot be undone.");
                if (!confirmDelete) return;

                try {
                    // Re-authenticate user if necessary (e.g., if session is old)
                    // You might need a popup or form for re-authentication
                    await user.delete();
                    // Remove user data from Realtime Database
                    if (database) {
                        await database.ref(`users/${user.uid}`).remove();
                        await database.ref(`pets/${user.uid}`).remove(); // Assuming pets are under user UID
                        await database.ref(`activityLogs/${user.uid}`).remove(); // Assuming activity logs are under user UID
                    }
                    showModal("Your account and all associated data have been deleted.");
                    showSection('about');
                } catch (error) {
                    console.error("Error deleting account:", error);
                    let errorMessage = "Failed to delete account: " + error.message;
                    if (error.code === 'auth/requires-recent-login') {
                        errorMessage = "Please sign in again to confirm account deletion. (Due to security, you must recently sign in to delete your account)";
                        // You'd typically prompt for re-authentication here (e.g., show login modal)
                        showSection('login'); // Redirect to login to re-authenticate
                    }
                    showModal(errorMessage);
                }
            } else {
                showModal("No user is signed in.");
            }
        }

        // --- Firebase Realtime Database Functions ---

        async function saveUserProfile(uid, name, email) {
            if (!database) return;
            try {
                await database.ref('users/' + uid).set({
                    name: name,
                    email: email,
                    createdAt: firebase.database.ServerValue.TIMESTAMP,
                    lastSeen: firebase.database.ServerValue.TIMESTAMP
                });
                console.log("User profile saved successfully.");
            } catch (error) {
                console.error("Error saving user profile:", error);
                showModal("Error saving profile: " + error.message);
            }
        }

        async function savePetProfile(uid, petId, petData) {
            if (!database) return;
            try {
                await database.ref(`pets/${uid}/${petId}`).set({
                    ...petData,
                    addedAt: firebase.database.ServerValue.TIMESTAMP
                });
                console.log("Pet profile saved successfully.");
                showModal("Pet added successfully!");
                populatePetProfile(uid); // Refresh pet list
            } catch (error) {
                console.error("Error saving pet profile:", error);
                showModal("Error adding pet: " + error.message);
            }
        }

        async function logUserActivity(uid, activityType, notes = '', petId = null) {
            if (!database) return;
            try {
                const activityRef = database.ref(`activityLogs/${uid}`).push();
                await activityRef.set({
                    type: activityType,
                    notes: notes,
                    petId: petId,
                    timestamp: firebase.database.ServerValue.TIMESTAMP
                });
                console.log("User activity logged successfully.");
                showModal("Activity logged!");
                populateActivityLog(uid); // Refresh activity log
            } catch (error) {
                console.error("Error logging activity:", error);
                showModal("Error logging activity: " + error.message);
            }
        }

        async function updateUserAnalytics(uid, data) {
            if (!database) return;
            try {
                await database.ref(`users/${uid}/analytics`).update(data);
                console.log("User analytics updated.");
            } catch (error) {
                console.error("Error updating analytics:", error);
            }
        }

        function setupUserDataListeners(uid) {
            if (!database) return;
            // Listen for user profile changes
            database.ref('users/' + uid).on('value', (snapshot) => {
                const userData = snapshot.val();
                if (userData) {
                    profileNameInput.value = userData.name || '';
                    profileEmailInput.value = userData.email || '';
                    console.log("User profile loaded:", userData.name);
                }
            });

            // Listen for pet data changes
            populatePetProfile(uid);

            // Listen for activity log changes
            populateActivityLog(uid);
        }

        function populatePetProfile(uid) {
            if (!database) return;
            const petRef = database.ref(`pets/${uid}`);
            petRef.on('value', (snapshot) => {
                petsList.innerHTML = ''; // Clear current list
                const pets = snapshot.val();
                if (pets) {
                    activityPetSelect.innerHTML = '<option value="">-- Select a Pet --</option>'; // Clear and add default option
                    Object.keys(pets).forEach(petId => {
                        const pet = pets[petId];
                        const petItem = document.createElement('div');
                        petItem.classList.add('feature-card'); // Reusing a card style
                        petItem.style.borderLeft = '4px solid hsl(var(--secondary))'; // Different color for pets
                        petItem.innerHTML = `
                            <div class="feature-header">
                                <span class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8Z"/><path d="M10 10v.01"/><path d="M14 10v.01"/><path d="M10 14c.83 1.33 2.17 1.33 3 0"/></svg></span>
                                <div>
                                    <h3 class="feature-title">${pet.name} (${pet.species}${pet.breed ? ', ' + pet.breed : ''})</h3>
                                    <p class="feature-description">Born: ${pet.dob || 'N/A'}</p>
                                </div>
                            </div>
                            <div style="text-align: right; margin-top: 1rem;">
                                <button type="button" class="form-button delete-pet-button" data-pet-id="${petId}" style="width: auto; background: #ef4444; padding: 0.5rem 1rem;">Delete</button>
                            </div>
                        `;
                        petsList.appendChild(petItem);

                        // Add to activity pet select
                        const option = document.createElement('option');
                        option.value = petId;
                        option.textContent = pet.name;
                        activityPetSelect.appendChild(option);
                    });

                    // Add event listeners for delete buttons
                    document.querySelectorAll('.delete-pet-button').forEach(button => {
                        button.addEventListener('click', async (e) => {
                            const petIdToDelete = e.target.dataset.petId;
                            const confirmDelete = confirm(`Are you sure you want to delete ${pets[petIdToDelete].name}?`);
                            if (confirmDelete) {
                                try {
                                    await database.ref(`pets/${uid}/${petIdToDelete}`).remove();
                                    showModal(`${pets[petIdToDelete].name} deleted successfully.`);
                                } catch (error) {
                                    console.error("Error deleting pet:", error);
                                    showModal("Error deleting pet: " + error.message);
                                }
                            }
                        });
                    });

                } else {
                    petsList.innerHTML = '<p style="text-align: center; color: hsl(var(--muted-foreground));">No pets added yet.</p>';
                    activityPetSelect.innerHTML = '<option value="">-- Select a Pet --</option>';
                }
            });
        }

        function populateActivityLog(uid) {
            if (!database) return;
            const activityRef = database.ref(`activityLogs/${uid}`).orderByChild('timestamp');
            activityRef.on('value', (snapshot) => {
                activityLogList.innerHTML = ''; // Clear current list
                const activities = snapshot.val();
                if (activities) {
                    const activityArray = Object.keys(activities).map(key => ({
                        id: key,
                        ...activities[key]
                    })).sort((a, b) => b.timestamp - a.timestamp); // Sort by timestamp descending

                    activityArray.forEach(activity => {
                        const activityItem = document.createElement('div');
                        activityItem.classList.add('feature-card');
                        activityItem.style.borderLeft = '4px solid hsl(var(--accent-foreground))';
                        const date = new Date(activity.timestamp);
                        const petName = activity.petId ? (document.querySelector(`#activityPetSelect option[value="${activity.petId}"]`)?.textContent || 'Unknown Pet') : 'N/A';
                        activityItem.innerHTML = `
                            <div class="feature-header" style="align-items: center;">
                                <span class="feature-icon"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"/><line x1="16" x2="16" y1="2" y2="6"/><line x1="8" x2="8" y1="2" y2="6"/><line x1="3" x2="21" y1="10" y2="10"/></svg></span>
                                <div>
                                    <h3 class="feature-title">${activity.type.replace(/_/g, ' ').replace(/\b\w/g, l => l.toUpperCase())}</h3>
                                    <p class="feature-description">
                                        ${date.toLocaleString()} ${activity.petId ? `(Pet: ${petName})` : ''}
                                        ${activity.notes ? `<br>Notes: ${activity.notes}` : ''}
                                    </p>
                                </div>
                            </div>
                        `;
                        activityLogList.appendChild(activityItem);
                    });
                } else {
                    activityLogList.innerHTML = '<p style="text-align: center; color: hsl(var(--muted-foreground));">No activities logged yet.</p>';
                }
            });
        }

        // --- Event Listeners ---

        // Authentication State Change
        auth.onAuthStateChanged((user) => {
            if (user) {
                currentUser = user;
                console.log("User signed in:", user.email);
                setupUserDataListeners(user.uid);

                // Update last seen
                if (database) {
                    database.ref(`users/${user.uid}/lastSeen`).set(firebase.database.ServerValue.TIMESTAMP);
                }
                // Show/hide navigation links based on auth state
                document.querySelectorAll('.nav-link[data-section="login"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.nav-link[data-section="signup"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.nav-link[data-section="profile"]').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.nav-link[data-section="pets"]').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.nav-link[data-section="activity"]').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.nav-link[data-section="settings"]').forEach(el => el.style.display = 'block');
                document.getElementById('signOutButton').style.display = 'block';

            } else {
                currentUser = null;
                console.log("User signed out");
                // Show/hide navigation links based on auth state
                document.querySelectorAll('.nav-link[data-section="login"]').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.nav-link[data-section="signup"]').forEach(el => el.style.display = 'block');
                document.querySelectorAll('.nav-link[data-section="profile"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.nav-link[data-section="pets"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.nav-link[data-section="activity"]').forEach(el => el.style.display = 'none');
                document.querySelectorAll('.nav-link[data-section="settings"]').forEach(el => el.style.display = 'none');
                document.getElementById('signOutButton').style.display = 'none';

                showSection('about'); // Redirect to about page if signed out
            }
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = loginEmail.value;
            const password = loginPassword.value;
            signIn(email, password);
        });

        signupForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const name = signupName.value;
            const email = signupEmail.value;
            const password = signupPassword.value;
            signUp(email, password, name);
        });

        if (googleLoginButton) {
            googleLoginButton.addEventListener('click', handleGoogleSignIn);
        }
        if (googleSignupButton) {
            googleSignupButton.addEventListener('click', handleGoogleSignIn);
        }

        if (signOutButton) {
            signOutButton.addEventListener('click', signOutUser);
        }

        if (forgotPasswordLink) {
            forgotPasswordLink.addEventListener('click', (e) => {
                e.preventDefault();
                const email = prompt("Please enter your email to reset your password:");
                if (email) {
                    resetPassword(email);
                }
            });
        }

        if (profileForm) {
            profileForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (currentUser) {
                    const newName = profileNameInput.value;
                    try {
                        await currentUser.updateProfile({ displayName: newName });
                        await saveUserProfile(currentUser.uid, newName, currentUser.email); // Update in Realtime Database as well
                        showModal("Profile updated successfully!");
                    } catch (error) {
                        console.error("Error updating profile:", error);
                        showModal("Error updating profile: " + error.message);
                    }
                } else {
                    showModal("No user signed in to update profile.");
                }
            });
        }

        if (deleteAccountButton) {
            deleteAccountButton.addEventListener('click', deleteAccount);
        }

        if (addPetForm) {
            addPetForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (currentUser) {
                    const petName = document.getElementById('petName').value;
                    const petSpecies = document.getElementById('petSpecies').value;
                    const petBreed = document.getElementById('petBreed').value;
                    const petDOB = document.getElementById('petDOB').value;

                    const newPetRef = database.ref(`pets/${currentUser.uid}`).push();
                    await savePetProfile(currentUser.uid, newPetRef.key, {
                        name: petName,
                        species: petSpecies,
                        breed: petBreed,
                        dob: petDOB
                    });
                    addPetForm.reset(); // Clear form
                } else {
                    showModal("Please sign in to add a pet.");
                }
            });
        }

        if (logActivityForm) {
            logActivityForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                if (currentUser) {
                    const selectedPetId = activityPetSelect.value;
                    const activityType = document.getElementById('activityType').value;
                    const activityNotes = document.getElementById('activityNotes').value;

                    if (!selectedPetId) {
                        showModal("Please select a pet for the activity.");
                        return;
                    }
                    await logUserActivity(currentUser.uid, activityType, activityNotes, selectedPetId);
                    logActivityForm.reset(); // Clear form
                } else {
                    showModal("Please sign in to log activities.");
                }
            });
        }


        // Page visibility tracking
        document.addEventListener('visibilitychange', () => {
            if (currentUser) {
                const eventType = document.hidden ? 'page_hidden' : 'page_visible';
                logUserActivity(currentUser.uid, eventType);
            }
        });

        // Initialize with about section visible
        showSection('about');

        // Performance monitoring
        window.addEventListener('load', () => {
            if (currentUser) {
                const loadTime = performance.now();
                updateUserAnalytics(currentUser.uid, {
                    pageLoadTime: loadTime,
                    lastPageLoad: firebase.database.ServerValue.TIMESTAMP
                });
            }
        });

        // Dark mode toggle
        function setDarkMode(isDark) {
            if (isDark) {
                document.body.classList.add('dark');
                localStorage.setItem('darkMode', 'enabled');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem('darkMode', 'disabled');
            }
        }

        // Check for saved dark mode preference
        if (localStorage.getItem('darkMode') === 'enabled') {
            setDarkMode(true);
        }

        darkToggle.addEventListener('click', () => {
            setDarkMode(!document.body.classList.contains('dark'));
        });

        if (settingsDarkToggle) {
            settingsDarkToggle.addEventListener('click', () => {
                setDarkMode(!document.body.classList.contains('dark'));
            });
        }

        console.log("Pet'emote application initialized with comprehensive Firebase Realtime Database integration");
    </script>
</body>
</html>
